"use strict";!function(){function t(){var t=document.getElementById("container"),i=new s(t);i.init(),window.addEventListener("resize",i.init.bind(i))}var i=function(){function t(t,i,e,s,n){void 0===t&&(t=0),void 0===i&&(i=0),void 0===e&&(e=0),void 0===s&&(s=0),void 0===n&&(n=0),this.x=t,this.y=i,this.vx=e,this.vy=s,this._radius=0,this._mass=0,this.m=n}return Object.defineProperty(t.prototype,"m",{get:function(){return this._mass},set:function(t){t!==this._mass&&(this._mass=t,this._radius=Math.pow(3*t/(4*Math.PI),1/3))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},enumerable:!0,configurable:!0}),t}(),e=667408e-10,s=function(){function t(t){this.container=t,this.initialMass=10,this.criticalMass=1e4,this.canvas=document.createElement("canvas"),this.canvas.id="nodegarden",this.ctx=this.canvas.getContext("2d"),1!==this.pixelRatio&&(this.canvas.style.transform="scale("+1/this.pixelRatio+")",this.canvas.style.transformOrigin="0 0"),this.container.appendChild(this.canvas),this.nodes=new Array(this.nodeCount)}return Object.defineProperty(t.prototype,"windowArea",{get:function(){return this.windowWidth*this.windowHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelRatio",{get:function(){return window.devicePixelRatio},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"windowWidth",{get:function(){return window.innerWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"windowHeight",{get:function(){return window.innerHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaledHeight",{get:function(){return this.windowHeight*this.pixelRatio},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaledWidth",{get:function(){return this.windowWidth*this.pixelRatio},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nodeCount",{get:function(){return 0|Math.sqrt(this.scaledHeight*this.scaledWidth/72)},enumerable:!0,configurable:!0}),t.prototype.init=function(){var t,i;for(this.canvas.width=this.scaledWidth,this.canvas.height=this.scaledHeight,this.nodes.length=this.nodeCount,t=0,i=this.nodes.length;i>t;t++)this.nodes[t]||(this.nodes[t]=this.createNode());this.renderRequest&&window.cancelAnimationFrame(this.renderRequest),this.renderRequest=window.requestAnimationFrame(this.render.bind(this))},t.prototype.createNode=function(t){return void 0===t&&(t=null),t?(t.x=Math.random()*this.scaledWidth,t.y=Math.random()*this.scaledHeight,t.vx=1*Math.random()-.5,t.vy=1*Math.random()-.5,t.m=this.initialMass):t=new i(Math.random()*this.scaledWidth,Math.random()*this.scaledHeight,1*Math.random()-.5,1*Math.random()-.5,this.initialMass),t},t.prototype.render=function(){var t,i,s,n,a,h,r,o,d,c,m,l,u;for(this.renderRequest=requestAnimationFrame(this.render.bind(this)),this.ctx.fillStyle="rgba(255, 255, 255, 0.1)",this.ctx.fillRect(0,0,this.scaledWidth,this.scaledHeight),o=0,c=this.nodes.length-1;c>o;o++)for(d=o+1;c+1>d;d++)m=this.nodes[o],l=this.nodes[d],r={x:l.x-m.x,y:l.y-m.y},t=Math.sqrt(Math.pow(r.x,2)+Math.pow(r.y,2)),t<m.radius+l.radius?(m.m<=l.m&&(m.x=Math.random()*this.scaledWidth,m.y=Math.random()*this.scaledHeight,l.vx+=m.vx*(m.m/l.m),l.vy+=m.vy*(m.m/l.m),m.vx=1*Math.random()-.5,m.vy=1*Math.random()-.5,l.m+=m.m,l.m>this.criticalMass&&(l.m=this.initialMass),m.m=this.initialMass),l.m<=m.m&&(l.x=Math.random()*this.scaledWidth,l.y=Math.random()*this.scaledHeight,m.vx+=l.vx*(l.m/m.m),m.vy+=l.vy*(l.m/m.m),l.vx=1*Math.random()-.5,l.vy=1*Math.random()-.5,m.m+=l.m,m.m>this.criticalMass&&(m.m=this.initialMass),l.m=this.initialMass)):(n={x:r.x/t,y:r.y/t},a=e*(m.m*l.m/Math.pow(t,2)),isNaN(a)||(h={x:a*n.x,y:a*n.y},m.vx+=l.m/m.m*h.x,m.vy+=l.m/m.m*h.y,l.vx-=m.m/l.m*h.x,l.vy-=m.m/l.m*h.y));for(o=0,c=this.nodes.length;c>o;o++)u=this.nodes[o],this.ctx.beginPath(),this.ctx.fillStyle="rgba("+Math.floor(255*(u.m/this.criticalMass))+", 0, 0, 1)",this.ctx.arc(u.x,u.y,u.radius,0,2*Math.PI),this.ctx.fill(),u.x+=u.vx,u.y+=u.vy,u.x<=0?(i=this.impactLoss(u.vx,u.vy,!0),s=1-.5*i,u.x=0,u.vx*=-s,u.vy*=s,u.y+=u.vy):u.x>=this.scaledWidth&&(i=this.impactLoss(u.vx,u.vy,!0),s=1-.5*i,u.x=this.scaledWidth,u.vx*=-s,u.vy*=s,u.y+=u.vy),u.y<=0?(i=this.impactLoss(u.vx,u.vy,!1),s=1-.5*i,u.y=0,u.vy*=-s,u.vx*=s,u.x+=u.vx):u.y>=this.scaledHeight&&(i=this.impactLoss(u.vx,u.vy,!1),s=1-.5*i,u.y=this.scaledHeight,u.vy*=-s,u.vx*=s,u.x+=u.vx)},t.prototype.impactLoss=function(t,i,e){var s=Math.abs(Math.atan(i/t))*(180/Math.PI);return e&&(s=90-s),s/90},t}();t()}();
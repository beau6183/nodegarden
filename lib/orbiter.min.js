var Box=function(){function t(t,i,e,s){this.x=t,this.y=i,this.w=e,this.h=s}return t.prototype.contains=function(t,i){return this.x<=t&&t<=this.x+this.w&&this.y<=i&&i<=this.y+this.h},t}(),Nodule=function(){function t(t,i,e,s,n){void 0===t&&(t=0),void 0===i&&(i=0),void 0===e&&(e=0),void 0===s&&(s=0),void 0===n&&(n=0),this.x=t,this.y=i,this.vx=e,this.vy=s,this._radius=0,this._mass=0,this.m=n}return Object.defineProperty(t.prototype,"m",{get:function(){return this._mass},set:function(t){t!==this._mass&&(this._mass=t,this._radius=Math.pow(3*t/(4*Math.PI),1/3))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},enumerable:!0,configurable:!0}),t}(),SpaceObject=function(){function t(t,i,e,s,n,a,r){void 0===r&&(r=1),this.name=t,this.velocity=i,this.distance=e,this.fillStyle=s,this.exaggeration=r,this._mass=0,this._density=1,this._radius=0,this.x=0,this.y=0,this.vx=0,this.vy=0,this.mass=n,this.density=a}return Object.defineProperty(t.prototype,"mass",{get:function(){return this._mass},set:function(t){t!==this._mass&&(this._mass=t,this.measure())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"density",{get:function(){return this._density},set:function(t){t!==this._mass&&(this._density=t,this.measure())},enumerable:!0,configurable:!0}),t.prototype.measure=function(){var t=this._mass/this._density;this._radius=Math.pow(3*t/(4*Math.PI),1/3)/1e3},Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},enumerable:!0,configurable:!0}),t}(),OrbitalController=function(){function t(t,i){this.container=t,this.G=6.67408e-11,this.scale=1,this.initial=!0,this.tick=0,this.canvas=document.createElement("canvas"),this.canvas.id="nodegarden",this.ctx=this.canvas.getContext("2d"),1!==this.pixelRatio&&(this.canvas.style.transform="scale("+1/this.pixelRatio+")",this.canvas.style.transformOrigin="0 0"),this.container.appendChild(this.canvas),this.solarSystem=i,window.addEventListener("resize",this.init.bind(this))}return Object.defineProperty(t.prototype,"windowArea",{get:function(){return this.windowWidth*this.windowHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pixelRatio",{get:function(){return window.devicePixelRatio},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"windowWidth",{get:function(){return window.innerWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"windowHeight",{get:function(){return window.innerHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaledHeight",{get:function(){return this.windowHeight*this.pixelRatio},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaledWidth",{get:function(){return this.windowWidth*this.pixelRatio},enumerable:!0,configurable:!0}),t.prototype.init=function(){this.canvas.width=this.scaledWidth,this.canvas.height=this.scaledHeight,this.renderRequest&&clearTimeout(this.renderRequest),this.lastTick=(new Date).getTime(),this.renderRequest=setTimeout(this.render.bind(this),1e3)},t.prototype.render=function(){var t=(new Date).getTime();this.tick=t-this.lastTick,this.lastTick=t,this.renderRequest=setTimeout(this.render.bind(this),1e3),this.calculateSystemScale(),this.ctx.fillStyle="rgba(0, 0, 0, 0.1)",this.ctx.fillRect(0,0,this.scaledWidth,this.scaledHeight),this.solarSystem.forEach(this.draw.bind(this)),this.initial=!1},t.prototype.calculateSystemScale=function(){var t,i,e=0;for(t=0;t<this.solarSystem.length;t++)i=this.solarSystem[t],e=Math.max(2*(i.distance+i.radius),e);this.scale=Math.min(this.scaledHeight,this.scaledWidth)/e},t.prototype.draw=function(t){var i,e,s,n,a;if((this.initial||t===this.solarSystem[0])&&(t.y=this.scaledHeight/2,t.x=this.scaledWidth/2-t.distance*this.scale),t!==this.solarSystem[0]){if(i={x:t.distance,y:t.distance},e=t.distance,s={x:i.x/e,y:i.y/e},n=this.G*(this.solarSystem[0].mass*t.mass/Math.pow(e,2)),isNaN(n))return;a={x:n*s.x,y:n*s.y},t.vx-=this.solarSystem[0].mass/t.mass*this.scale*a.x,t.vy-=this.solarSystem[0].mass/t.mass*this.scale*a.y,console.log({scale:this.scale,force:a,vx:t.vx,vy:t.vy,x:t.x,y:t.y})}this.ctx.beginPath(),this.ctx.fillStyle=t.fillStyle,this.ctx.arc(t.x,t.y,t.radius*this.scale*t.exaggeration,0,2*Math.PI),this.ctx.fill(),this.ctx.beginPath(),this.ctx.strokeStyle="rgba(255, 255, 255, 0.5)",this.ctx.arc(this.solarSystem[0].x,this.solarSystem[0].y,t.distance*this.scale,0,2*Math.PI),this.ctx.stroke(),t.x+=t.vx,t.y+=t.vy},t}();